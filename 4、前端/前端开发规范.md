# å‰ç«¯å¼€å‘è§„èŒƒ

> ğŸ“… æœ€åæ›´æ–°ï¼š2026-01-11
> ğŸ“‹ åŸºäºé¡¹ç›®æºç é€†å‘åˆ†æç”Ÿæˆ

---

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

### Cunkebao (ä¸»å‰ç«¯)

| æŠ€æœ¯ | ç‰ˆæœ¬ | è¯´æ˜ |
|------|------|------|
| React | 18.2.0 | æ ¸å¿ƒæ¡†æ¶ |
| TypeScript | 5.4.5 | ç±»å‹ç³»ç»Ÿ |
| Vite | 7.0.5 | æ„å»ºå·¥å…· |
| Zustand | 5.0.6 | çŠ¶æ€ç®¡ç† |
| Ant Design | 5.13.1 | PCç«¯ç»„ä»¶åº“ |
| Ant Design Mobile | 5.39.1 | ç§»åŠ¨ç«¯ç»„ä»¶åº“ |
| SASS | 1.75.0 | CSSé¢„å¤„ç† |
| react-window | 1.8.11 | è™šæ‹Ÿæ»šåŠ¨ |

---

## ğŸ“ ç›®å½•ç»“æ„

```
Cunkebao/
â”œâ”€â”€ public/                 # é™æ€èµ„æº
â”‚   â”œâ”€â”€ logo.png
â”‚   â”œâ”€â”€ manifest.json
â”‚   â””â”€â”€ websdk.js
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ api/               # API æ¥å£å°è£…
â”‚   â”‚   â”œâ”€â”€ auth.ts        # è®¤è¯æ¥å£
â”‚   â”‚   â”œâ”€â”€ device.ts      # è®¾å¤‡æ¥å£
â”‚   â”‚   â””â”€â”€ wechat.ts      # å¾®ä¿¡æ¥å£
â”‚   â”œâ”€â”€ components/        # é€šç”¨ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ common/        # åŸºç¡€ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ business/      # ä¸šåŠ¡ç»„ä»¶
â”‚   â”‚   â””â”€â”€ layout/        # å¸ƒå±€ç»„ä»¶
â”‚   â”œâ”€â”€ pages/             # é¡µé¢ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ device/        # è®¾å¤‡ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ wechat/        # å¾®ä¿¡ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ content/       # å†…å®¹åº“
â”‚   â”‚   â”œâ”€â”€ workbench/     # å·¥ä½œå°
â”‚   â”‚   â””â”€â”€ traffic/       # æµé‡ç®¡ç†
â”‚   â”œâ”€â”€ router/            # è·¯ç”±é…ç½®
â”‚   â”‚   â””â”€â”€ index.tsx
â”‚   â”œâ”€â”€ store/             # Zustand çŠ¶æ€
â”‚   â”‚   â”œâ”€â”€ userStore.ts
â”‚   â”‚   â”œâ”€â”€ deviceStore.ts
â”‚   â”‚   â””â”€â”€ wechatStore.ts
â”‚   â”œâ”€â”€ styles/            # å…¨å±€æ ·å¼
â”‚   â”‚   â””â”€â”€ global.scss
â”‚   â”œâ”€â”€ types/             # TypeScript ç±»å‹
â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”œâ”€â”€ utils/             # å·¥å…·å‡½æ•°
â”‚   â”‚   â”œâ”€â”€ request.ts     # HTTP è¯·æ±‚å°è£…
â”‚   â”‚   â”œâ”€â”€ storage.ts     # æœ¬åœ°å­˜å‚¨
â”‚   â”‚   â””â”€â”€ format.ts      # æ ¼å¼åŒ–å·¥å…·
â”‚   â”œâ”€â”€ App.tsx            # æ ¹ç»„ä»¶
â”‚   â””â”€â”€ main.tsx           # å…¥å£æ–‡ä»¶
â”œâ”€â”€ package.json
â”œâ”€â”€ tsconfig.json
â”œâ”€â”€ vite.config.ts
â””â”€â”€ postcss.config.js
```

---

## ğŸ¨ è§†è§‰è§„èŒƒ (iOS é£æ ¼)

### å­—ä½“æ ˆ

```css
font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Text', 
             'PingFang SC', 'Helvetica Neue', sans-serif;
```

### è‰²å½©ç³»ç»Ÿ

```scss
// ä¸»è‰²è°ƒ
$primary-color: #007AFF;      // iOS ç³»ç»Ÿè“
$success-color: #34C759;      // æˆåŠŸç»¿
$warning-color: #FF9500;      // è­¦å‘Šæ©™
$error-color: #FF3B30;        // é”™è¯¯çº¢

// èƒŒæ™¯è‰²
$bg-primary: #FFFFFF;         // ä¸»èƒŒæ™¯
$bg-secondary: #F2F2F7;       // åˆ†ç»„èƒŒæ™¯
$bg-tertiary: #E5E5EA;        // ç¬¬ä¸‰èƒŒæ™¯

// æ–‡å­—è‰²
$text-primary: #000000;       // ä¸»æ–‡å­—
$text-secondary: #8E8E93;     // æ¬¡è¦æ–‡å­—
$text-tertiary: #C7C7CC;      // è¾…åŠ©æ–‡å­—

// åˆ†å‰²çº¿
$border-color: #C6C6C8;
```

### åœ†è§’è§„èŒƒ

```scss
$radius-sm: 4px;
$radius-md: 8px;
$radius-lg: 12px;
$radius-xl: 16px;
$radius-full: 9999px;
```

### é˜´å½±è§„èŒƒ

```scss
// è½»é˜´å½±
$shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.1);
// ä¸­é˜´å½±
$shadow-md: 0 4px 6px rgba(0, 0, 0, 0.1);
// é‡é˜´å½±
$shadow-lg: 0 10px 15px rgba(0, 0, 0, 0.1);
```

---

## ğŸ“¦ ç»„ä»¶è§„èŒƒ

### ç»„ä»¶æ–‡ä»¶ç»“æ„

```
ComponentName/
â”œâ”€â”€ index.tsx              # ç»„ä»¶ä¸»æ–‡ä»¶
â”œâ”€â”€ index.scss             # ç»„ä»¶æ ·å¼
â”œâ”€â”€ types.ts               # ç±»å‹å®šä¹‰
â””â”€â”€ hooks.ts               # è‡ªå®šä¹‰ Hooks
```

### ç»„ä»¶å‘½å

```tsx
// âœ… æ­£ç¡®
export const DeviceList: React.FC<DeviceListProps> = () => {}
export const WechatCard: React.FC<WechatCardProps> = () => {}

// âŒ é”™è¯¯
export const deviceList = () => {}
export const wechat_card = () => {}
```

### ç»„ä»¶æ¨¡æ¿

```tsx
import React, { FC, memo, useCallback } from 'react';
import styles from './index.scss';

interface ComponentNameProps {
  title: string;
  onAction?: () => void;
}

export const ComponentName: FC<ComponentNameProps> = memo(({ 
  title, 
  onAction 
}) => {
  const handleClick = useCallback(() => {
    onAction?.();
  }, [onAction]);

  return (
    <div className={styles.container}>
      <h1>{title}</h1>
      <button onClick={handleClick}>Action</button>
    </div>
  );
});

ComponentName.displayName = 'ComponentName';
```

---

## ğŸ”„ çŠ¶æ€ç®¡ç† (Zustand)

### Store å®šä¹‰

```tsx
// store/deviceStore.ts
import { create } from 'zustand';
import { devtools, persist } from 'zustand/middleware';

interface DeviceState {
  devices: Device[];
  loading: boolean;
  setDevices: (devices: Device[]) => void;
  addDevice: (device: Device) => void;
  removeDevice: (id: number) => void;
}

export const useDeviceStore = create<DeviceState>()(
  devtools(
    persist(
      (set) => ({
        devices: [],
        loading: false,
        setDevices: (devices) => set({ devices }),
        addDevice: (device) => 
          set((state) => ({ devices: [...state.devices, device] })),
        removeDevice: (id) => 
          set((state) => ({ 
            devices: state.devices.filter(d => d.id !== id) 
          })),
      }),
      { name: 'device-storage' }
    )
  )
);
```

### Store ä½¿ç”¨

```tsx
// åœ¨ç»„ä»¶ä¸­ä½¿ç”¨
const { devices, loading, setDevices } = useDeviceStore();

// é€‰æ‹©æ€§è®¢é˜…ï¼ˆæ€§èƒ½ä¼˜åŒ–ï¼‰
const devices = useDeviceStore((state) => state.devices);
```

---

## ğŸ“¡ API è¯·æ±‚

### è¯·æ±‚å°è£…

```tsx
// utils/request.ts
import axios, { AxiosRequestConfig } from 'axios';

const instance = axios.create({
  baseURL: import.meta.env.VITE_API_URL,
  timeout: 30000,
});

// è¯·æ±‚æ‹¦æˆª
instance.interceptors.request.use((config) => {
  const token = localStorage.getItem('token');
  if (token) {
    config.headers.Authorization = `Bearer ${token}`;
  }
  return config;
});

// å“åº”æ‹¦æˆª
instance.interceptors.response.use(
  (response) => response.data,
  (error) => {
    if (error.response?.status === 401) {
      // Token è¿‡æœŸå¤„ç†
      localStorage.removeItem('token');
      window.location.href = '/login';
    }
    return Promise.reject(error);
  }
);

export const request = <T>(config: AxiosRequestConfig): Promise<T> => {
  return instance(config);
};
```

### API å®šä¹‰

```tsx
// api/device.ts
import { request } from '@/utils/request';

export const deviceApi = {
  // è·å–è®¾å¤‡åˆ—è¡¨
  getList: (params?: DeviceListParams) => 
    request<ApiResponse<DeviceListData>>({
      url: '/v1/devices',
      method: 'GET',
      params,
    }),

  // è·å–è®¾å¤‡è¯¦æƒ…
  getDetail: (id: number) => 
    request<ApiResponse<Device>>({
      url: `/v1/devices/${id}`,
      method: 'GET',
    }),

  // åˆ›å»ºè®¾å¤‡
  create: (data: CreateDeviceData) => 
    request<ApiResponse<Device>>({
      url: '/v1/devices',
      method: 'POST',
      data,
    }),
};
```

---

## ğŸ­ äº¤äº’è§„èŒƒ

### éª¨æ¶å±ï¼ˆå¼ºåˆ¶ï¼‰

```tsx
import { Skeleton } from 'antd-mobile';

// âœ… æ­£ç¡®ï¼šä½¿ç”¨éª¨æ¶å±
{loading ? (
  <Skeleton.Paragraph lineCount={5} animated />
) : (
  <DataList data={data} />
)}

// âŒ é”™è¯¯ï¼šä½¿ç”¨ç®€å•çš„ Loading æ–‡å­—
{loading ? 'åŠ è½½ä¸­...' : <DataList data={data} />}
```

### è½¬åœºåŠ¨ç”»

```tsx
// è·¯ç”±åˆ‡æ¢åŠ¨ç”»
import { CSSTransition, TransitionGroup } from 'react-transition-group';

<TransitionGroup>
  <CSSTransition
    key={location.key}
    classNames="page"
    timeout={300}
  >
    <Routes location={location}>
      {/* routes */}
    </Routes>
  </CSSTransition>
</TransitionGroup>
```

### è™šæ‹Ÿæ»šåŠ¨ï¼ˆé•¿åˆ—è¡¨ï¼‰

```tsx
import { FixedSizeList } from 'react-window';

<FixedSizeList
  height={500}
  itemCount={items.length}
  itemSize={60}
  width="100%"
>
  {({ index, style }) => (
    <div style={style}>
      <ListItem item={items[index]} />
    </div>
  )}
</FixedSizeList>
```

---

## âœ… ä»£ç è§„èŒƒ

### ESLint é…ç½®

```json
{
  "extends": [
    "eslint:recommended",
    "plugin:react/recommended",
    "plugin:@typescript-eslint/recommended",
    "prettier"
  ],
  "rules": {
    "react/react-in-jsx-scope": "off",
    "@typescript-eslint/no-explicit-any": "warn",
    "@typescript-eslint/explicit-function-return-type": "off"
  }
}
```

### Prettier é…ç½®

```json
{
  "semi": true,
  "singleQuote": true,
  "tabWidth": 2,
  "trailingComma": "es5",
  "printWidth": 80
}
```

---

## ğŸš€ å¼€å‘æµç¨‹

1. **å¯¹é½éœ€æ±‚**ï¼šé˜…è¯» `å¼€å‘æ–‡æ¡£/1ã€éœ€æ±‚/ä¸šåŠ¡éœ€æ±‚.md`
2. **è®¾è®¡è¿˜åŸ**ï¼šå‚è€ƒåŸå‹ä¸ iOS é£æ ¼è§„èŒƒ
3. **ç»„ä»¶å¼€å‘**ï¼šä¼˜å…ˆå¤ç”¨å·²æœ‰ç»„ä»¶
4. **çŠ¶æ€ç®¡ç†**ï¼šä½¿ç”¨ Zustand ç®¡ç†å…¨å±€çŠ¶æ€
5. **è”è°ƒæµ‹è¯•**ï¼šç¡®ä¿æ¥å£å¼‚å¸¸å¤„ç†æ­£å¸¸
6. **ä»£ç å®¡æŸ¥**ï¼šæäº¤å‰è¿è¡Œ `pnpm lint` å’Œ `pnpm format`

---

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **TypeScript**ï¼šé¿å…ä½¿ç”¨ `any`ï¼Œä¼˜å…ˆä½¿ç”¨æ˜ç¡®ç±»å‹
2. **æ€§èƒ½ä¼˜åŒ–**ï¼šä½¿ç”¨ `memo`ã€`useCallback`ã€`useMemo` é¿å…ä¸å¿…è¦æ¸²æŸ“
3. **éª¨æ¶å±**ï¼šæ‰€æœ‰æ•°æ®åŠ è½½åŒºåŸŸå¿…é¡»ä½¿ç”¨éª¨æ¶å±
4. **è™šæ‹Ÿæ»šåŠ¨**ï¼šè¶…è¿‡ 50 æ¡æ•°æ®çš„åˆ—è¡¨å¿…é¡»ä½¿ç”¨è™šæ‹Ÿæ»šåŠ¨
5. **å›¾ç‰‡æ‡’åŠ è½½**ï¼šæ‰€æœ‰å›¾ç‰‡å¿…é¡»ä½¿ç”¨æ‡’åŠ è½½
6. **é”™è¯¯è¾¹ç•Œ**ï¼šé¡µé¢çº§ç»„ä»¶éœ€è¦åŒ…è£¹ ErrorBoundary
